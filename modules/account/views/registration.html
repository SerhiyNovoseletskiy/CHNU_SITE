<header class="content-title"><h1 class="title"><?=REGISTRATION?></h1>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/bootstrapValidator.css">

    <script src="js/jquery-1.10.2.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootstrapValidator.js"></script>
    <div class="md-margin"></div>
</header>
<div class="col-md-12" id = "information">
    <?
    if (isset($data['error']))
    foreach($data['error'] as $error){?>
    <div class="alert alert-danger">
        <?=$error?>
    </div>
    <?}?>
</div>
<form method="post" action="/account/reg" id="registerForm">
    <div class="col-md-6">
    <div class="xs-margin"></div>
        <!--Login-->
        <div class="col-md-12">
        <label><?=USER_LOGIN?></label>
        <input required value="<?=$data['user']['login']?>" class="form-control input-sm" name="login" id = 'login' type="text">
        </div>
        <!--Password-->
        <div class="col-md-12">
            <label><?=USER_PASS?></label>
            <input required class="form-control input-sm" name="password"  type="password">
        </div>
        <!--Email-->
        <div class="col-md-12">
            <label title="<?=EMAIL_HINT?>"><?=EMAIL?></label>
            <input required value="<?=$data['user']['email']?>" class="form-control input-sm" id="email" name="email" type="email" alt="<?=EMAIL_HINT?>" title="<?=EMAIL_TITLE?>">
    </div>
        <!--Surname-->
        <div class="col-md-12">
            <label><?=SUR_NAME?></label>
            <input class="form-control input-sm" name="sur_name" value="<?=$data['user']['sur_name']?>" type="text" title="<?=SUR_NAME_TITLE?>">
            <script src="js/jquery.lemongrab.js">$("input[name=sur_name]").lemongrab();</script>
        </div>
        <!--Firstname-->
        <div class="col-md-12">
            <label><?=FIRST_NAME?></label>
            <input required class="form-control input-sm" value="<?=$data['user']['first_name']?>" name="first_name" type="text" pattern="^[A-Z]{1}[a-z]+$" title="<?=FIRST_NAME_TITLE?>">
        </div>
        <!--Middle name-->
        <div class="col-md-12">
            <label><?= MIDDLE_NAME?></label>
            <input required class="form-control input-sm" value="<?=$data['user']['middle_name']?>" name="middle_name" type="text" pattern="^[A-Z]{1}[a-z]+$" title="<?=MIDDLE_NAME_TITLE?>">
        </div>
        <!--Birthday-->
        <div class="col-md-12">
            <label><?=BIRTHDAY?></label>
            <input required class="form-control input-sm" value="<?=$data['user'][birthday]?>" name="birthday" type="date">
        </div>
    <div class="sm-margin"></div>
</div>
    <div class="col-md-6">
        <div class="xs-margin"></div>
        <!--Telephone-->
        <div class="col-md-12">
            <label><?=TELEPHONE?></label>
            <input class="form-control input-sm" name="telephone" value="<?=$data['user']['telephone']?>" type="text" pattern="\+[3][8][0][0-9]{9}" required title="<?=TELEPHONE_TITLE?>"/>
        </div>
        <!--Year of entry-->
        <div class="col-md-12">
            <label><?=ENTRY_YEAR?></label>
            <input class="form-control input-sm" name="entry_year" value="<?=$data['user']['entry_year']?>" type="text" pattern="[0-9]{4}" required title="<?=ENTRY_YEAR_TITLE?>"/>
        </div>
        <!--Graduation year-->
        <div class="col-md-12">
            <label><?=GRADUATION_YEAR?></label>
            <input required class="form-control input-sm" name="graduation_year" value="<?=$data['user']['graduation_year']?>" type="text" pattern="[0-9]{4}" title="<?=GRADUATION_YEAR_TITLE?>">
        </div>
        <!--Department (Novoseletskiy)-->
        <div class="col-md-12">
            <label><?=DEPARTMENT?></label>
            <select class="form-control" name="department" required>
                <option value="">-- <?=DEPARTMENT?> --</option>
                <?foreach($data['departments'] as $dep) {?>
                <option value="<?=$dep->_id?>"><?=$dep->name?></option>
                <?}?>
            </select>
        </div>
        <!--Speciality-->
        <div class="col-md-12">
            <label><?=SPECIALITY?></label>
            <select class="form-control" name="speciality" required>
                <option value="">-- <?=SPECIALITY?> --</option>
            </select>
        </div>
        <!--Form of teaching-->
        <div class="col-md-12">
            <label><?=TEACHING_FORM?></label>
            <select class="form-control" name="teaching_form" required>
                <option value="">-- <?=TEACHING_FORM?> --</option>
                <option value="<?=TEACHING_FORM1?>"><?=TEACHING_FORM1?></option>
                <option value="<?=TEACHING_FORM2?>"><?=TEACHING_FORM2?></option>
                <option value="<?=TEACHING_FORM3?>"><?=TEACHING_FORM3?></option>
            </select>
        </div>
        <!--Educational qualification-->
        <div class="col-md-12">
            <label title="<?=EDUCATION_QUALIFICATION_HINT?>"><?=EDUCATION_QUALIFICATION?></label>
            <select class="form-control" name="education_qualification" required>
                <option value="">-- <?=EDUCATION_QUALIFICATION?> --</option>
                <option value="<?=EDUCATION_QUALIFICATION1?>"><?=EDUCATION_QUALIFICATION1?></option>
                <option value="<?=EDUCATION_QUALIFICATION2?>"><?=EDUCATION_QUALIFICATION2?></option>
                <option value="<?=EDUCATION_QUALIFICATION3?>"><?=EDUCATION_QUALIFICATION3?></option>
                <option value="<?=EDUCATION_QUALIFICATION4?>"><?=EDUCATION_QUALIFICATION4?></option>
            </select>
        </div>
        <!--Additional info-->
        <div class="col-md-12">
            <label><?=ADDITIONAL_INFO?></label>
            <textarea required class="form-control input-sm" name="additional_info" value="<?=$data['user']['additional_info']?>"></textarea>
        </div>
        <div class="sm-margin"></div>


        <style type="text/css">
            #loginForm .has-error .control-label,
            #loginForm .has-error .help-block,
            #loginForm .has-error .form-control-feedback {
                color: #f39c12;
            }

            #loginForm .has-success .control-label,
            #loginForm .has-success .help-block,
            #loginForm .has-success .form-control-feedback {
                color: #18bc9c;
            }
        </style>

        <form id="loginForm" method="post" class="form-horizontal">
            <div class="form-group">
                <label class="col-xs-3 control-label">Username</label>
                <div class="col-xs-5">
                    <input type="text" class="form-control" name="username" />
                </div>
            </div>

            <div class="form-group">
                <label class="col-xs-3 control-label">Password</label>
                <div class="col-xs-5">
                    <input type="password" class="form-control" name="password" />
                </div>
            </div>

            <div class="form-group">
                <div class="col-xs-9 col-xs-offset-3">
                    <button type="submit" class="btn btn-primary">Sign in</button>
                </div>
            </div>
        </form>

        <script>
            $(document).ready(function() {
                $('#loginForm').formValidation({
                    framework: 'bootstrap',
                    icon: {
                        valid: 'glyphicon glyphicon-ok',
                        invalid: 'glyphicon glyphicon-remove',
                        validating: 'glyphicon glyphicon-refresh'
                    },
                    fields: {
                        username: {
                            validators: {
                                notEmpty: {
                                    message: 'The username is required'
                                },
                                stringLength: {
                                    min: 6,
                                    max: 30,
                                    message: 'The username must be more than 6 and less than 30 characters long'
                                },
                                regexp: {
                                    regexp: /^[a-zA-Z0-9_\.]+$/,
                                    message: 'The username can only consist of alphabetical, number, dot and underscore'
                                }
                            }
                        },
                        password: {
                            validators: {
                                notEmpty: {
                                    message: 'The password is required'
                                }
                            }
                        }
                    }
                });
            });
        </script>



    </div>
<div class="col-md-6">
    <button class="btn btn-custom btn-success"><?=REGISTRATION?></button>
    <h5><?=FIELDS_HINT?></h5>

</div>
</form>
<script>
    function form_valid() {
        $.post('/account/valid',{login: $("#login").val(), email: $("#email").val()}, function(d){
           $("#information").html(d);
        });
    }
    $('select[name=department]').change(function(){
        //alert($(this).val());
        $.ajax({
            // Send data
            type: 'POST',
            url: '/account/get_speciality_by_department_id/',
            data: {department_id: $(this).val()},
            success: function(response){
                $('select[name=speciality]').html(response);
            }
        });
    });
</script>
